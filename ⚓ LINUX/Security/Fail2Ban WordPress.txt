Fail2Ban Защита WordPress

* Настройка Fail2Ban для мониторинга журналов WordPress
* Здесь описаны все необходимые фильтры для WordPress

Важно! Следите за тем, чтобы путь к файлу хранения логов logpath был указан корректно. 
Обязательно назначьте ему необходимые права доступа командой chmod 755 /var/log/XXX.log
* У вас должны быть определены базовые параметры [DEFAULT] в jail.local

*** Конфигурация Fail2ban настраивается
--- $ nano /etc/fail2ban/jail.local

*** Управление активными фильтрами
--- $ cd /etc/fail2ban/filter.d


*** Защита WordPress от подбора паролей

--- jail.local -------------------------------------------------------------------
----------------------------------------------------------------------------------
[wp-login]

enabled   = true
port      = http,https
filter    = wp-login
logpath   = /var/log/apache2/access.log
-----------------------------------------------------------------------------------
--- wp-login.conf -----------------------------------------------------------------
-----------------------------------------------------------------------------------
[Definition]

failregex = ^<HOST> .*POST /wp-login\.php.*

ignoreregex =
-----------------------------------------------------------------------------------
-----------------------------------------------------------------------------------
*** Проверка срабатывания правил
--- $ fail2ban-regex /var/log/apache2/access.log /etc/fail2ban/filter.d/wp-login.conf


*** После внесения изменений в jail.local

* Проверить состояние fail2ban
--- $ systemctl status fail2ban

* Перезапустить сервис
--- $ service fail2ban restart

* Получение информации о включенных фильтрах
--- $ fail2ban-client status

